!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";const r={user:"admin",password:"admidn99999",siteDomain:"blog.gezhong.vip",privateBlog:!1,siteName:"CF workers blog",siteDescription:"A Blog Run On Cloudflare Workers and KV",keyWords:"cloudflare,KV,workers,blog",pageSize:5,recentlySize:3,readMoreLength:150,cacheZoneId:"cc858e8edce4097ad4a7357442722897",cacheToken:"LNxRWH-MPMIGnp8qhyT8FUsjDRN6tdOnm7B5Mdrz",cacheTime:60,widgetOther:'\n<div id="linkcat-0" class="widget widget_links">\n\t<h3 class="widget-title">\n\t\t<span>最近评论</span></h3>\n\t<div id="waline-recent"></div>\n\t<script>\n\t\twindow.addEventListener(\'load\', function() {\n\t\t  Waline.Widget.RecentComments({\n\t\t\tel: \'#waline-recent\',\n\t\t\tserverURL: \'https://pinglun.vercel.app\',\n\t\t\tcount: 10\n\t\t  });\n\t\t});\n\t<\/script>\n</div>\n    ',themeURL:"https://raw.githubusercontent.com/gdtool/cloudflare-workers-blog/master/themes/JustNews/",html404:"<h1>404</h1>",codeBeforHead:'\n    <link rel="icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/gdtool/zhaopp/cfblog/favicon.ico" />\n<link rel="Shortcut Icon" href="https://cdn.jsdelivr.net/gh/gdtool/zhaopp/cfblog/favicon.ico">\n    <script src=\'//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js\'><\/script>\n\n    <script data-ad-client="ca-pub-0224824489587078" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"><\/script>\n    ',codeBeforBody:"\n        <script>\n            new Waline({\n                el:'#waline',\n                serverURL: 'https://pinglun.vercel.app',\n                appId: 'eWrOzSzYP1Fm8QDx96P0vKli-MdYXbMMI',\n                appKey: 'jMF98EwbmKvdGnDLamPwsAk1',\n                avatar:'monsterid',\n                recordIP:false,\n                requiredFields:['nick'],\n                visitor: true,\n                //path:\"/\",\n                placeholder:\"整两句...\"\n            })\n        <\/script>\n        <script>\n            //hljs.initHighlightingOnLoad();\n            var _hmt = _hmt || [];\n            (function() {\n            var hm = document.createElement(\"script\");\n            hm.src = \"https://hm.baidu.com/hm.js?3c82d815b755ee9b789cb004067c1fc7\";\n            var s = document.getElementsByTagName(\"script\")[0]; \n            s.parentNode.insertBefore(hm, s);\n            })();\n        <\/script>\n    ",commentCode:'\n        <div id="waline"  name="waline" class="comments-area"></div>\n\n    ',otherCodeA:"阅读:",otherCodeB:"",otherCodeC:"",otherCodeD:"",otherCodeE:"",copyRight:'Powered by <a href="https://www.cloudflare.com">Cloudflare</a> & <a href="https://blog.gezhong.vip">CF-Blog </a>',robots:"User-agent: *\nDisallow: /admin"},a=n(1);async function i(t,e,n){e=decodeURI(e);let i=await p("index"),o=await l("SYSTEM_VALUE_WidgetMenu",!0),c=await l("SYSTEM_VALUE_WidgetCategory",!0),u=await l("SYSTEM_VALUE_WidgetTags",!0),g=await l("SYSTEM_VALUE_WidgetLink",!0),h=(await l("SYSTEM_INDEX_LIST",!0)).slice(0,r.recentlySize);for(var d=0;d<h.length;d++)h[d].createDate10=h[d].createDate.substr(0,10),h[d].url="/article/"+h[d].id+"/"+h[d].link+".html";let f=await s(e,n),w=f[0],m=f[1];for(d=0;d<w.length;d++)w[d].createDate10=w[d].createDate.substr(0,10),w[d].createDateYear=w[d].createDate.substr(0,4),w[d].createDateMonth=w[d].createDate.substr(5,7),w[d].createDateDay=w[d].createDate.substr(8,10),w[d].contentLength=w[d].contentText.length,w[d].url="/article/"+w[d].id+"/"+w[d].link+".html";let y=[{title:"上一页",url:"/"+t+"/"+e+"/"+(n-1)}];1==n&&(y=[]);let S=[{title:"下一页",url:"/"+t+"/"+e+"/"+(n+1)}];m&&(S=[]);let v=e+" - "+r.siteName,b=e,T={};T.widgetMenuList=o,T.widgetCategoryList=c,T.widgetTagsList=u,T.widgetLinkList=g,T.widgetRecentlyList=h,T.articleList=w,T.pageNewer=y,T.pageOlder=S,T.title=v,T.keyWords=b;let E=Object.assign({},r);return E.password="",E.user="",E.cacheToken="",E.cacheZoneId="",T.OPT=E,a.render(i,T)}async function s(t,e,n=r.pageSize){t=decodeURI(t),console.log("进入函数: getKVArticleCategory",t,e,n),e=e<=1?1:e;let a=await l("SYSTEM_INDEX_LIST",!0),i=[];for(var s=0,o=a.length;s<o;s++)(a[s].tags.indexOf(t)>-1||a[s].category.indexOf(t)>-1)&&i.push(a[s]);i=h(i,"id");let c=!(i.length>n*e),u=[];for(s=(e-1)*n,o=Math.min(e*n,i.length);s<o;s++)u.push(i[s]);return u=h(u,"id"),[u,c]}async function o(t){t=("00000"+parseInt(t)).substr(-6);let e=await l("SYSTEM_INDEX_LIST",!0),n=-1;for(var r=0,a=e.length;r<a;r++)if(e[r].id==t){n=r;break}let i=await l(t,!0);return null==i||0===i.length?[void 0,void 0,void 0]:[e[n-1],i,e[n+1]]}async function c(t,e=r.pageSize){t=t<=1?1:t;let n=await l("SYSTEM_INDEX_LIST",!0),a=!(n.length>e*t),i=[];for(var s=(t-1)*e,o=Math.min(t*e,n.length);s<o;s++)i.push(n[s]);return i=h(i,"id"),[i,a]}async function l(t,e=!1){console.log("------------KV读取---------------------:",t,e);let n=await CFBLOG.get(t);if(!e)return null==n?"[]":n;try{return null==n?[]:JSON.parse(n)}catch(t){return[]}}async function u(t,e){return null!=e&&null!=e&&("object"==typeof e&&(e=JSON.stringify(e)),await CFBLOG.put(t,e))}function g(t){return t>=0&&t<=9?"0"+t:t}async function p(t){return t=t.replace(".html",""),(await fetch(r.themeURL+t+".html",{cf:{cacheTtl:600}})).text()}function h(t,e,n=!0){return t.sort((function(t,r){var a=t[e],i=r[e];return n?a>i?-1:a<i?1:0:a<i?-1:a>i?1:0}))}function d(t){if("string"==typeof t)try{var e=JSON.parse(t);return!("object"!=typeof e||!e)}catch(t){return!1}return!("object"!=typeof t||!t)}async function f(t){const{headers:e}=t,n=e.get("content-type")||"";if(n.includes("application/json")){let e=JSON.stringify(await t.json()),n=JSON.parse(e),a={category:[]};for(var r=0;r<n.length;r++)"tags"==n[r].name?a[n[r].name]=n[r].value.split(","):n[r].name.includes("category")?a.category.push(n[r].value):a[n[r].name]=n[r].value;return a}if(n.includes("application/text"))return await t.text();if(n.includes("text/html"))return await t.text();if(n.includes("form")){const e=await t.formData(),n={};for(const t of e.entries())n[t[0]]=t[1];return JSON.stringify(n)}{const e=await t.blob();return URL.createObjectURL(e)}}addEventListener("fetch",t=>{t.respondWith(async function(t){let e=t.request,n=new URL(t.request.url);null==r.privateBlog&&(r.privateBlog=!1);let s=n.pathname.trim("/").split("/");if(("admin"===s[0]||!0===r.privateBlog)&&!function(t){const e=t.headers.get("Authorization");if(!e||!/^Basic [A-Za-z0-9._~+/-]+=*$/i.test(e))return!1;const[n,a]=function(t){try{return atob(t.split(" ").pop()).split(":")}catch(t){return[]}}(e);return console.log("-----parseBasicAuth----- ",n,a),n===r.user&&a===r.password}(t.request))return new Response("Unauthorized",{headers:{"WWW-Authenticate":'Basic realm="cfblog"',"Access-Control-Allow-Origin":"*"},status:401});if("admin"===s[0]&&"export"===s[1]){let t=await async function t(e=[],n="",a=1){const i=await CFBLOG.list({limit:a,cursor:n});if(e=e.concat(i.keys),i.list_complete){let t={OPT:r};for(let n=0;n<e.length;++n){const r=await CFBLOG.get(e[n].name);null!=r&&(t[e[n].name]=d(r)?JSON.parse(r):r)}return t}return await t(e,i.cursor,a)}();return new Response(JSON.stringify(t),{headers:{"content-type":"application/octet-stream;charset=utf-8","Content-Disposition":"attachment; filename=cfblog-"+(w=new Date,m=g(w.getMonth()+1),y=g(w.getDate()),S=g(w.getHours()),v=g(w.getMinutes()),b=g(w.getSeconds()),T=w.getFullYear()+"-"+m+"-"+y+"T"+S+":"+v+":"+b,T+".json")}})}var w,m,y,S,v,b,T;console.log(n.pathname);let E=n.searchParams.get("theme"),L=n.searchParams.get("pageSize");E&&(r.themeURL="https://raw.githubusercontent.com/gdtool/cloudflare-workers-blog/master/themes/"+E+"/");L&&(r.pageSize=parseInt(L));"https://raw.githubusercontent.com/gdtool/cloudflare-workers-blog/master/themes/default/"==r.themeURL&&(r.themeURL="https://raw.githubusercontent.com/gdtool/cloudflare-workers-blog/master/themes/default2.0/");if(console.log("theme pageSize",r.pageSize,r.themeURL),"/robots.txt"==n.pathname)return new Response(r.robots+"\nSitemap: https://"+r.siteDomain+"/sitemap.xml",{headers:{"content-type":"text/plain;charset=UTF-8"},status:200});if("/favicon.ico"==n.pathname)return new Response("404",{headers:{"content-type":"text/plain;charset=UTF-8"},status:404});let _="",D="",M="";0==s.length||""==s[0]?(_="page",D="1"):(_=s[0],D=void 0===s[1]?1:s[1],M=void 0===s[2]?1:s[2]);const k=caches.default,x="https://"+r.siteDomain+"/"+_+"/"+D+"/"+M,O=new Request(x,e);console.log("cacheFullPath:",x);let C=await k.match(O);if(C)return C;if("sitemap.xml"==_)C=new Response(await async function(){console.log("进入函数 getSiteMap");let t=await l("SYSTEM_INDEX_LIST",!0),e='<?xml version="1.0" encoding="UTF-8"?>\n<urlset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd" xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">';for(var n=0,a=t.length;n<a;n++)e+="\n\t<url>",e+="\n\t\t<loc>https://"+r.siteDomain+"/article/"+t[n].id+"/"+t[n].link+".html</loc>",e+="\n\t\t<lastmod>"+t[n].createDate.substr(0,10)+"</lastmod>",e+="\n\t\t<changefreq>"+(void 0===t[n].changefreq?"daily":t[n].changefreq)+"</changefreq>",e+="\n\t\t<priority>"+(void 0===t[n].priority?"0.5":t[n].priority)+"</priority>",e+="\n\t</url>";return e+="\n</urlset>",e}(),{headers:{"content-type":"text/xml;charset=UTF-8"},status:200});else{let e=await async function(t){let e=new URL(t.url).pathname.trim("/").split("/"),n="",s="",g="";0==e.length||""==e[0]?(n="page",s="1"):(n=e[0],s=void 0===e[1]?1:e[1],g=void 0===e[2]?1:e[2]);if("page"==n&&parseInt(s)>0)return await async function(t,e){let n=await p("index"),i=await l("SYSTEM_VALUE_WidgetMenu",!0),s=await l("SYSTEM_VALUE_WidgetCategory",!0),o=await l("SYSTEM_VALUE_WidgetTags",!0),c=await l("SYSTEM_VALUE_WidgetLink",!0),u=await l("SYSTEM_INDEX_LIST",!0),g=u.slice(0,r.recentlySize);for(var h=0;h<g.length;h++)g[h].createDate10=g[h].createDate.substr(0,10),g[h].url="/article/"+g[h].id+"/"+g[h].link+".html";let d=u.slice((e-1)*r.pageSize,e*r.pageSize);for(h=0;h<d.length;h++)d[h].createDate10=d[h].createDate.substr(0,10),d[h].createDateYear=d[h].createDate.substr(0,4),d[h].createDateMonth=d[h].createDate.substr(5,7),d[h].createDateDay=d[h].createDate.substr(8,10),d[h].contentLength=d[h].contentText.length,d[h].url="/article/"+d[h].id+"/"+d[h].link+".html";let f=[{title:"上一页",url:"/page/"+(e-1)}];1==e&&(f=[]);let w=[{title:"下一页",url:"/page/"+(e+1)}];e*r.pageSize>=u.length&&(w=[]);let m=(e>1?"page "+e+" - ":"")+r.siteName,y=r.keyWords,S={};S.widgetMenuList=i,S.widgetCategoryList=s,S.widgetTagsList=o,S.widgetLinkList=c,S.widgetRecentlyList=g,S.articleList=d,S.pageNewer=f,S.pageOlder=w,S.title=m,S.keyWords=y;let v=Object.assign({},r);return v.password="",v.user="",v.cacheToken="",v.cacheZoneId="",S.OPT=v,a.render(n,S)}(0,parseInt(s));if("category"==n&&s.length>0)return await i(n,s,parseInt(g));if("tags"==n&&s.length>0)return await i(n,s,parseInt(g));if("article"==n&&s.length>0)return await async function(t,e,n){let i=await p("article"),s=await l("SYSTEM_VALUE_WidgetMenu",!0),c=await l("SYSTEM_VALUE_WidgetCategory",!0),u=await l("SYSTEM_VALUE_WidgetTags",!0),g=await l("SYSTEM_VALUE_WidgetLink",!0),h=(await l("SYSTEM_INDEX_LIST",!0)).slice(0,r.recentlySize);for(var d=0;d<h.length;d++)h[d].createDate10=h[d].createDate.substr(0,10),h[d].url="/article/"+h[d].id+"/"+(void 0===h[d].link?"detail":h[d].link)+".html";let f=await o(e);for(d=0;d<f.length;d++)f[d]&&(f[d].createDate10=f[d].createDate.substr(0,10),f[d].contentLength=f[d].contentText.length,f[d].url="/article/"+f[d].id+"/"+(void 0===f[d].link?"detail":f[d].link)+".html");let w=f[1];w&&(w.createDate10=w.createDate.substr(0,10),w.createDateYear=w.createDate.substr(0,4),w.createDateMonth=w.createDate.substr(5,7),w.createDateDay=w.createDate.substr(8,10),w.contentLength=w.contentText.length);let m=[],y=[];f[0]&&m.push(f[0]);f[2]&&y.push(f[2]);let S=w.title+" - "+r.siteName,v=w.tags.concat(w.category).join(","),b={};b.widgetMenuList=s,b.widgetCategoryList=c,b.widgetTagsList=u,b.widgetLinkList=g,b.widgetRecentlyList=h,b.articleSingle=w,b.articleNewer=m,b.articleOlder=y,b.title=S,b.keyWords=v;let T=Object.assign({},r);return T.password="",T.user="",T.cacheToken="",T.cacheZoneId="",b.OPT=T,a.render(i,b)}(0,s);if("search"!=n)return"admin"==n?await async function(t,e){new URL(t.url);if(1==e.length||"list"==e[1]){let t=await p("admin/index"),e=await l("SYSTEM_VALUE_WidgetCategory",!0),n=await l("SYSTEM_VALUE_WidgetMenu",!0),r=await l("SYSTEM_VALUE_WidgetLink",!0);return t.r("categoryJson",JSON.stringify(e)).r("menuJson",JSON.stringify(n)).r("linkJson",JSON.stringify(r))}if("publish"==e[1]){let t=await l("SYSTEM_INDEX_LIST",!0),e=[];for(var n=0;n<t.length;n++)if("object"==typeof t[n].tags)for(var a=0;a<t[n].tags.length;a++)-1==e.indexOf(t[n].tags[a])&&e.push(t[n].tags[a]);return await u("SYSTEM_VALUE_WidgetTags",JSON.stringify(e)),await async function(t=r.cacheZoneId,e=r.cacheToken){if(null==t||null==e||t.length<5||e.length<5)return!1;let n=await fetch(`https://api.cloudflare.com/client/v4/zones/${t}/purge_cache`,{method:"POST",headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"},body:'{"purge_everything":true}'});return(await n.json()).success}()?'{"msg":"published ,purge Cache true","rst":true}':'{"msg":"published ,buuuuuuuuuuuut purge Cache false !!!!!!","rst":true}'}if("getList"==e[1]){let t=void 0===e[2]?1:parseInt(e[2]),n=await c(t,20);return JSON.stringify(n[0])}if("edit"==e[1]){let t=e[2],n=await p("admin/edit"),r=await l("SYSTEM_VALUE_WidgetCategory"),a=await l(t);return n.r("categoryJson",r).r("articleJson",a.replaceAll("script>","script＞"))}if("saveConfig"==e[1]){const e=await f(t);let n=e.WidgetCategory,r=e.WidgetMenu,a=e.WidgetLink;return d(n)&&d(r)?(await u("SYSTEM_VALUE_WidgetCategory",n),await u("SYSTEM_VALUE_WidgetMenu",r),await u("SYSTEM_VALUE_WidgetLink",a),'{"msg":"saved","rst":true}'):'{"msg":"Not a JSON object","rst":false}'}if("import"==e[1]){let e=(await f(t)).importJson;if(d(e)){let t=Object.keys(e);for(let n=0;n<t.length;++n)await u(t[n],e[t[n]]);return'{"msg":"import success!","rst":true}'}return'{"msg":" importJson Not a JSON object","rst":false}'}if("saveAddNew"==e[1]){const e=await f(t);let n=e.title,a=e.img,i=e.link,s=e.createDate,o=e.category,c=e.tags,g=void 0===e.priority?"0.5":e.priority,p=void 0===e.changefreq?"daily":e.changefreq,d=e["content-markdown-doc"],w=e["content-html-code"],m="",y="";if(n.length>0&&s.length>0&&o.length>0&&d.length>0&&w.length>0){y=await async function(){let t=await l("SYSTEM_INDEX_NUM");return""===t||null===t||"[]"===t||void 0===t?(await u("SYSTEM_INDEX_NUM",1),"000001"):(await u("SYSTEM_INDEX_NUM",parseInt(t)+1),("00000"+(parseInt(t)+1)).substr(-6))}(),m=w.replace(/<\/?[^>]*>/g,"").trim().substring(0,r.readMoreLength);let t={id:y,title:n,img:a,link:i,createDate:s,category:o,tags:c,contentMD:d,contentHtml:w,contentText:m,priority:g,changefreq:p};await u(y,JSON.stringify(t));let e={id:y,title:n,img:a,link:i,createDate:s,category:o,tags:c,contentText:m,priority:g,changefreq:p},f=await l("SYSTEM_INDEX_LIST",!0),S=[];return S.push(e),S=S.concat(f),S=h(S,"id"),await u("SYSTEM_INDEX_LIST",JSON.stringify(S)),'{"msg":"added OK","rst":true,"id":"'+y+'"}'}return'{"msg":"信息不全","rst":false}'}if("delete"==e[1]){let t=e[2];if(6==t.length){await CFBLOG.delete(t);let e=await l("SYSTEM_INDEX_LIST",!0);for(n=0;n<e.length;n++)t==e[n].id&&e.splice(n,1);return await u("SYSTEM_INDEX_LIST",JSON.stringify(e)),'{"msg":"Delete ('+t+')  OK","rst":true,"id":"'+t+'"}'}return'{"msg":"Delete  false ","rst":false,"id":"'+t+'"}'}if("saveEdit"==e[1]){const e=await f(t);let a=e.title,i=e.img,s=e.link,o=e.createDate,c=e.category,g=e.tags,p=e["content-markdown-doc"],d=e["content-html-code"],w=void 0===e.priority?"0.5":e.priority,m=void 0===e.changefreq?"daily":e.changefreq,y="",S=e.id;if(a.length>0&&o.length>0&&c.length>0&&p.length>0&&d.length>0){y=d.replace(/<\/?[^>]*>/g,"").trim().substring(0,r.readMoreLength);let t={id:S,title:a,img:i,link:s,createDate:o,category:c,tags:g,contentMD:p,contentHtml:d,contentText:y,priority:w,changefreq:m};await u(S,JSON.stringify(t));let e={id:S,title:a,img:i,link:s,createDate:o,category:c,tags:g,contentText:y,priority:w,changefreq:m},f=await l("SYSTEM_INDEX_LIST",!0);for(n=0;n<f.length;n++)S==f[n].id&&f.splice(n,1);return f.push(e),f=h(f,"id"),await u("SYSTEM_INDEX_LIST",JSON.stringify(f)),'{"msg":"Edit OK","rst":true,"id":"'+S+'"}'}return'{"msg":"信息不全","rst":false}'}return'{"msg":"some errors","rst":false}'}(t,e):r.html404;return r.html404}(t.request);C=new Response(e,{headers:{"content-type":"text/html;charset=UTF-8"},status:200})}"admin"==_?C.headers.set("Cache-Control","no-store"):(C.headers.set("Cache-Control","public, max-age="+r.cacheTime),t.waitUntil(k.put(x,C.clone())));return C}(t))}),String.prototype.trim=function(t){return t?this.replace(new RegExp("^\\"+t+"+|\\"+t+"+$","g"),""):this.replace(/^\s+|\s+$/g,"")},String.prototype.r=function(t,e){return null!=e&&(e=e.replace(new RegExp("[$]","g"),"$$$$")),this.replace(new RegExp("\x3c!--{"+t+"}--\x3e","g"),e)},String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"g"),e)}},function(t,e,n){t.exports=function(){"use strict";
/*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   */var t=Object.prototype.toString,e=Array.isArray||function(e){return"[object Array]"===t.call(e)};function n(t){return"function"==typeof t}function r(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function a(t,e){return null!=t&&"object"==typeof t&&e in t}var i=RegExp.prototype.test,s=/\S/;function o(t){return!function(t,e){return i.call(t,e)}(s,t)}var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},l=/\s*/,u=/\s+/,g=/\s*=/,p=/\s*\}/,h=/#|\^|\/|>|\{|&|=|!/;function d(t){this.string=t,this.tail=t,this.pos=0}function f(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function w(){this.templateCache={_cache:{},set:function(t,e){this._cache[t]=e},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}d.prototype.eos=function(){return""===this.tail},d.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},d.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},f.prototype.push=function(t){return new f(t,this)},f.prototype.lookup=function(t){var e,r,i,s=this.cache;if(s.hasOwnProperty(t))e=s[t];else{for(var o,c,l,u=this,g=!1;u;){if(t.indexOf(".")>0)for(o=u.view,c=t.split("."),l=0;null!=o&&l<c.length;)l===c.length-1&&(g=a(o,c[l])||(r=o,i=c[l],null!=r&&"object"!=typeof r&&r.hasOwnProperty&&r.hasOwnProperty(i))),o=o[c[l++]];else o=u.view[t],g=a(u.view,t);if(g){e=o;break}u=u.parent}s[t]=e}return n(e)&&(e=e.call(this.view)),e},w.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},w.prototype.parse=function(t,n){var a=this.templateCache,i=t+":"+(n||m.tags).join(":"),s=void 0!==a,c=s?a.get(i):void 0;return null==c&&(c=function(t,n){if(!t)return[];var a,i,s,c=!1,f=[],w=[],y=[],S=!1,v=!1,b="",T=0;function E(){if(S&&!v)for(;y.length;)delete w[y.pop()];else y=[];S=!1,v=!1}function L(t){if("string"==typeof t&&(t=t.split(u,2)),!e(t)||2!==t.length)throw new Error("Invalid tags: "+t);a=new RegExp(r(t[0])+"\\s*"),i=new RegExp("\\s*"+r(t[1])),s=new RegExp("\\s*"+r("}"+t[1]))}L(n||m.tags);for(var _,D,M,k,x,O,C=new d(t);!C.eos();){if(_=C.pos,M=C.scanUntil(a))for(var U=0,I=M.length;U<I;++U)o(k=M.charAt(U))?(y.push(w.length),b+=k):(v=!0,c=!0,b+=" "),w.push(["text",k,_,_+1]),_+=1,"\n"===k&&(E(),b="",T=0,c=!1);if(!C.scan(a))break;if(S=!0,D=C.scan(h)||"name",C.scan(l),"="===D?(M=C.scanUntil(g),C.scan(g),C.scanUntil(i)):"{"===D?(M=C.scanUntil(s),C.scan(p),C.scanUntil(i),D="&"):M=C.scanUntil(i),!C.scan(i))throw new Error("Unclosed tag at "+C.pos);if(x=">"==D?[D,M,_,C.pos,b,T,c]:[D,M,_,C.pos],T++,w.push(x),"#"===D||"^"===D)f.push(x);else if("/"===D){if(!(O=f.pop()))throw new Error('Unopened section "'+M+'" at '+_);if(O[1]!==M)throw new Error('Unclosed section "'+O[1]+'" at '+_)}else"name"===D||"{"===D||"&"===D?v=!0:"="===D&&L(M)}if(E(),O=f.pop())throw new Error('Unclosed section "'+O[1]+'" at '+C.pos);return function(t){for(var e,n=[],r=n,a=[],i=0,s=t.length;i<s;++i)switch((e=t[i])[0]){case"#":case"^":r.push(e),a.push(e),r=e[4]=[];break;case"/":a.pop()[5]=e[2],r=a.length>0?a[a.length-1][4]:n;break;default:r.push(e)}return n}(function(t){for(var e,n,r=[],a=0,i=t.length;a<i;++a)(e=t[a])&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(r.push(e),n=e));return r}(w))}(t,n),s&&a.set(i,c)),c},w.prototype.render=function(t,e,n,r){var a=this.getConfigTags(r),i=this.parse(t,a),s=e instanceof f?e:new f(e,void 0);return this.renderTokens(i,s,n,t,r)},w.prototype.renderTokens=function(t,e,n,r,a){for(var i,s,o,c="",l=0,u=t.length;l<u;++l)o=void 0,"#"===(s=(i=t[l])[0])?o=this.renderSection(i,e,n,r,a):"^"===s?o=this.renderInverted(i,e,n,r,a):">"===s?o=this.renderPartial(i,e,n,a):"&"===s?o=this.unescapedValue(i,e):"name"===s?o=this.escapedValue(i,e,a):"text"===s&&(o=this.rawValue(i)),void 0!==o&&(c+=o);return c},w.prototype.renderSection=function(t,r,a,i,s){var o=this,c="",l=r.lookup(t[1]);if(l){if(e(l))for(var u=0,g=l.length;u<g;++u)c+=this.renderTokens(t[4],r.push(l[u]),a,i,s);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)c+=this.renderTokens(t[4],r.push(l),a,i,s);else if(n(l)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(r.view,i.slice(t[3],t[5]),(function(t){return o.render(t,r,a,s)})))&&(c+=l)}else c+=this.renderTokens(t[4],r,a,i,s);return c}},w.prototype.renderInverted=function(t,n,r,a,i){var s=n.lookup(t[1]);if(!s||e(s)&&0===s.length)return this.renderTokens(t[4],n,r,a,i)},w.prototype.indentPartial=function(t,e,n){for(var r=e.replace(/[^ \t]/g,""),a=t.split("\n"),i=0;i<a.length;i++)a[i].length&&(i>0||!n)&&(a[i]=r+a[i]);return a.join("\n")},w.prototype.renderPartial=function(t,e,r,a){if(r){var i=this.getConfigTags(a),s=n(r)?r(t[1]):r[t[1]];if(null!=s){var o=t[6],c=t[5],l=t[4],u=s;0==c&&l&&(u=this.indentPartial(s,l,o));var g=this.parse(u,i);return this.renderTokens(g,e,r,u,a)}}},w.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return n},w.prototype.escapedValue=function(t,e,n){var r=this.getConfigEscape(n)||m.escape,a=e.lookup(t[1]);if(null!=a)return"number"==typeof a&&r===m.escape?String(a):r(a)},w.prototype.rawValue=function(t){return t[1]},w.prototype.getConfigTags=function(t){return e(t)?t:t&&"object"==typeof t?t.tags:void 0},w.prototype.getConfigEscape=function(t){return t&&"object"==typeof t&&!e(t)?t.escape:void 0};var m={name:"mustache.js",version:"4.1.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){y.templateCache=t},get templateCache(){return y.templateCache}},y=new w;return m.clearCache=function(){return y.clearCache()},m.parse=function(t,e){return y.parse(t,e)},m.render=function(t,n,r,a){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+(e(i=t)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return y.render(t,n,r,a)},m.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,(function(t){return c[t]}))},m.Scanner=d,m.Context=f,m.Writer=w,m}()}]);